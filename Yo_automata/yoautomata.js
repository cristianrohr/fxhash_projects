let palette,grid,gridx,gridy,x,y,dlevel,dcombo,dcomboprob,pset,nstates,threshold,range,dtype,fsize=800,iratio=.8,mcca=!0,diterations=0,ssignal=75;function setup(){size=windowHeight<windowWidth?windowHeight:windowWidth,createCanvas(size*iratio,size),pg=createGraphics(size*iratio,size),palette=randomFromArray(palettes),dcomboprob=fxrand(),dlevel=round(fxRandom(2,8)),ssignal=2==dlevel?75:3==dlevel?100:ssignal*dlevel/3,pset=fxrand(),setParameters(pset,dlevel,dcomboprob),gridx=round(fsize*iratio/dlevel),gridy=round(fsize/dlevel),grid=workGrid(gridx,gridy);for(let r=0;r<gridx;r++)for(let e=0;e<gridy;e++)grid[r][e]=floor(fxRandom(nstates))}function draw(){image(pg,0,0,width,height),ssignal==diterations?(fxpreview(),noLoop()):(doWork(),diterations+=1)}function keyPressed(){var e;"e"==key?save("Yo_automata_"+fxhash+".png"):"h"==key&&(pixelDensity(8),snew=800,e=snew/size,resizeCanvas(snew*iratio,snew),pg.scale(e),save("Yo_automata_highRes_"+fxhash+".png"))}function doWork(){if(frameCount%1==0){for(let r=0;r<gridx;r++)for(let e=0;e<gridy;e++)x=r*dlevel,y=e*dlevel,doDraw(r,e,x,y);calculateNext(workGrid(gridx,gridy),gridx,gridy)}}function calculateNext(l,e,a){for(let t=0;t<e;t++)for(let r=0;r<a;r++){let e=grid[t][r];countNeighbors(t,r)>=threshold&&(e=(e+1)%nstates),l[t][r]=e}grid=l}function doDraw(e,r,t,l){1==dtype?0==grid[e][r]?(pg.fill(palette.arr[0]),pg.stroke(palette.arr[0]),pg.strokeWeight(5),pg.point(t,l)):1==grid[e][r]?(pg.fill(palette.arr[1]),pg.stroke(palette.arr[1]),pg.strokeWeight(0),pg.circle(t,l,dlevel,dlevel)):2==grid[e][r]?(pg.fill(palette.arr[2]),pg.stroke(palette.arr[2]),pg.strokeWeight(1),pg.rect(t,l,dlevel,dlevel)):3==grid[e][r]?(pg.fill(palette.arr[3]),pg.stroke(palette.arr[3]),pg.strokeWeight(1),pg.line(t,l,t+2*dlevel,l+2*dlevel)):4==grid[e][r]&&(pg.fill(palette.arr[4]),pg.stroke(palette.arr[4]),pg.strokeWeight(1),pg.rect(t,l,dlevel,dlevel)):2==dtype?0==grid[e][r]?(pg.fill(palette.arr[0]),pg.stroke(palette.arr[0]),pg.strokeWeight(5),pg.point(t,l)):1==grid[e][r]?(pg.fill(palette.arr[1]),pg.stroke(palette.arr[1]),pg.strokeWeight(1),pg.line(t,l,t+2*dlevel,l+2*dlevel)):2==grid[e][r]?(pg.fill(palette.arr[2]),pg.stroke(palette.arr[2]),pg.strokeWeight(5),pg.point(t,l)):3==grid[e][r]?(pg.fill(palette.arr[3]),pg.stroke(palette.arr[3]),pg.strokeWeight(1),pg.line(t,l,t+2*dlevel,l-2*dlevel)):4==grid[e][r]&&(pg.fill(palette.arr[4]),pg.stroke(palette.arr[4]),pg.strokeWeight(5),pg.point(t,l)):3==dtype?0==grid[e][r]?(pg.fill(palette.arr[0]),pg.stroke(palette.arr[0]),pg.strokeWeight(0),pg.circle(t,l,dlevel,dlevel)):1==grid[e][r]?(pg.fill(palette.arr[1]),pg.stroke(palette.arr[1]),pg.strokeWeight(1),pg.rect(t,l,dlevel,dlevel)):2==grid[e][r]?(pg.fill(palette.arr[2]),pg.stroke(palette.arr[2]),pg.strokeWeight(0),pg.circle(t,l,dlevel,dlevel)):3==grid[e][r]?(pg.fill(palette.arr[3]),pg.stroke(palette.arr[3]),pg.strokeWeight(1),pg.rect(t,l,dlevel,dlevel)):4==grid[e][r]&&(pg.fill(palette.arr[4]),pg.stroke(palette.arr[4]),pg.strokeWeight(0),pg.circle(t,l,dlevel,dlevel)):4==dtype&&(0==grid[e][r]?(pg.fill(palette.arr[0]),pg.stroke(palette.arr[0]),pg.strokeWeight(0),pg.rect(t,l,dlevel,dlevel)):1==grid[e][r]?(pg.fill(palette.arr[1]),pg.stroke(palette.arr[1]),pg.strokeWeight(1),pg.rect(t,l,dlevel,dlevel)):2==grid[e][r]?(pg.fill(palette.arr[2]),pg.stroke(palette.arr[2]),pg.strokeWeight(0),pg.rect(t,l,dlevel,dlevel)):3==grid[e][r]?(pg.fill(palette.arr[3]),pg.stroke(palette.arr[3]),pg.strokeWeight(1),pg.rect(t,l,dlevel,dlevel)):4==grid[e][r]&&(pg.fill(palette.arr[4]),pg.stroke(palette.arr[4]),pg.strokeWeight(0),pg.rect(t,l,dlevel,dlevel)))}function workGrid(e,r){let t=new Array(e);for(let e=0;e<t.length;e++)t[e]=new Array(r);return t}function countNeighbors(t,l){let a=0,e=grid[t][l],i=e+1==nstates?0:e+1;for(let r=-range;r<=range;r++)for(let e=-range;e<=range;e++){var g;0==r&&0==e||!mcca&&0!=r&&0!=e||(g=(l+e+gridy)%gridy,a+=grid[(t+r+gridx)%gridx][g]==i)}return a}function setParameters(e,r,t){dcombo=t<.4?(dtype=1,"point;rect;circle;line"):t<.65?(dtype=2,"point;line"):t<.85?(dtype=3,"circle;rect"):(dtype=4,"rect"),range=e<.4?(nstates=5,threshold=15,4):e<.65?(nstates=4,threshold=2,1):e<.8?(nstates=5,threshold=2,1):(threshold=e<.9?(nstates=5,4):nstates=5,2),window.$fxhashFeatures={Palette:palette.name,States:nstates,Threshold:threshold,Range:range,DetailLevel:2==dlevel?"high":5<=dlevel?"low":"medium",DrawingCombo:dcombo,MaxIterations:ssignal},print(window.$fxhashFeatures)}function randomFromArray(e){return e[Math.floor(fxrand()*e.length)]}function fxRandom(e,r){return Array.isArray(e)?e[int(fxrand()*e.length)]:(void 0===r&&(r=e,e=0),fxrand()*(r-e)+e)}const palettes=[{name:"ocean five",arr:["#00A0B0","#6A4A3C","#CC333F","#EB6841","#EDC951"]},{name:"dance to forget",arr:["#FF4E50","#FC913A","#F9D423","#EDE574","#E1F5C4"]},{name:"let them eat cake",arr:["#774F38","#E08E79","#F1D4AF","#ECE5CE","#C5E0DC"]},{name:"cheer up emo kid",arr:["#556270","#4ECDC4","#C7F464","#FF6B6B","#C44D58"]},{name:"coup de grÃ¢ce",arr:["#99B898","#FECEA8","#FF847C","#E84A5F","#2A363B"]},{name:"curiosity killed",arr:["#EFFFCD","#DCE9BE","#555152","#2E2633","#99173C"]},{name:"thought provoking",arr:["#ECD078","#D95B43","#C02942","#542437","#53777A"]},{name:"fresh cut day",arr:["#00A8C6","#40C0CB","#F9F2E7","#AEE239","#8FBE00"]},{name:"compatible",arr:["#3FB8AF","#7FC7AF","#DAD8A7","#FF9E9D","#FF3D7F"]},{name:"claire de lune",arr:["#413E4A","#73626E","#B38184","#F0B49E","#F7E4BE"]},{name:"terra",arr:["#E8DDCB","#CDB380","#036564","#033649","#031634"]},{name:"w o r d l e s s",arr:["#FFFFFF","#CBE86B","#F2E9E1","#1C140D","#CBE86B"]}];
